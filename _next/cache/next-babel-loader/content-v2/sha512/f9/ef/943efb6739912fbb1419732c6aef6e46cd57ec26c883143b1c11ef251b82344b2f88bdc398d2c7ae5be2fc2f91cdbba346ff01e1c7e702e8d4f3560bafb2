{"ast":null,"code":"import { createRequestRoot } from '../../api/request';\nimport { getOrigin } from '../../api/utils';\nimport { KEYS } from '../../utils/constants';\nimport { createError } from '../../utils/createError';\nimport { ptbk } from '../../utils/ptbk';\nexport const config = {\n  api: {\n    bodyParser: {\n      sizeLimit: '1mb'\n    }\n  }\n};\n/**\n * 捕获所有路由\n * > 用于客户端请求的反向代理\n */\n\nexport default (async (req, res) => {\n  const requestRoot = createRequestRoot(req.headers);\n\n  try {\n    const apiRes = await requestRoot({\n      url: req.url,\n      method: req.method,\n      data: req.body\n    });\n    const {\n      data\n    } = apiRes;\n    res.writeHead(200, {\n      'Access-Control-Allow-Credentials': 'true',\n      'Access-Control-Allow-Origin': getOrigin()\n    });\n    const result = ptbk.encode(data);\n    res.end(JSON.stringify(result));\n  } catch (error) {\n    res.end(JSON.stringify({\n      [KEYS.error]: createError(error)\n    }));\n  }\n});","map":null,"metadata":{},"sourceType":"module"}