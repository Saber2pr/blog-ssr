{"ast":null,"code":"import createAxiosMonad from '@saber2pr/next-with-axios';\nimport { createRequestRoot } from '../api/request';\nimport { KEYS } from '../utils/constants';\nimport { createError } from '../utils/createError';\nimport { ptbk } from '../utils/ptbk';\nimport { withRedirect } from './withRedirect';\nexport const AxiosMonad = createAxiosMonad(async (handler, ctx) => {\n  var _ctx$req;\n\n  const reqHeaders = ctx === null || ctx === void 0 ? void 0 : (_ctx$req = ctx.req) === null || _ctx$req === void 0 ? void 0 : _ctx$req.headers;\n  const requestRoot = createRequestRoot(reqHeaders);\n  const result = {\n    props: {}\n  };\n\n  try {\n    // 服务端HTTP Exception统一捕获\n    result.props = await handler(requestRoot, ctx);\n  } catch (error) {\n    result.props[KEYS.error] = createError(error);\n  } finally {\n    result.props = ptbk.encode(result.props);\n    return result;\n  }\n});\nexport const withAxios = withRedirect(AxiosMonad);","map":null,"metadata":{},"sourceType":"module"}