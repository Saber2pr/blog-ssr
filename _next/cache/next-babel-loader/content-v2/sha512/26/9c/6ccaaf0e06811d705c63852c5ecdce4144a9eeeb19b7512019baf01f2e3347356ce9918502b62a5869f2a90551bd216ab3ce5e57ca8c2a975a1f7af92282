{"ast":null,"code":"import { clearVisitors } from './../../api/visitors';\nimport { getOrigin } from './../../api/utils';\nimport { getVisitors, pushVisitor } from '../../api/visitors';\nexport const config = {\n  api: {\n    bodyParser: {\n      sizeLimit: '1mb'\n    }\n  }\n};\nexport default (async (req, res) => {\n  try {\n    const method = req.method.toLowerCase();\n    res.writeHead(200, {\n      'Access-Control-Allow-Credentials': 'true',\n      'Access-Control-Allow-Origin': getOrigin()\n    });\n\n    if (method === 'post') {\n      res.end(JSON.stringify({\n        status: 200,\n        data: pushVisitor(JSON.parse(req.body)),\n        message: 'push ok.'\n      }));\n    }\n\n    if (method === 'get') {\n      var _req$query;\n\n      const clear = req === null || req === void 0 ? void 0 : (_req$query = req.query) === null || _req$query === void 0 ? void 0 : _req$query.clear;\n      return res.end(JSON.stringify({\n        status: 200,\n        data: clear ? clearVisitors() : getVisitors(),\n        message: 'get ok.'\n      }));\n    }\n  } catch (error) {\n    console.log(error);\n    res.end(JSON.stringify({\n      status: 500,\n      data: {},\n      message: 'error'\n    }));\n  }\n});","map":null,"metadata":{},"sourceType":"module"}