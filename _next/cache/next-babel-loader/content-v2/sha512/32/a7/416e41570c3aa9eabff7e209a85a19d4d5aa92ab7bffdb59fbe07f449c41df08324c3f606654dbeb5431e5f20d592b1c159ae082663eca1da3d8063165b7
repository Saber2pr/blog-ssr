{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport './style.less';\nimport { useState } from 'react';\nimport { getContent } from '../../api/getContent';\nimport { getData } from '../../api/getData';\nimport { MainLayout } from '../../common/main-layout';\nimport { ScrollToTop } from '../../components';\nimport { Info, matchText, matchType } from '../../modules';\nimport { withAxios } from '../../plugin/withAxios';\nimport { withPage } from '../../plugin/withPage';\nimport { timeDeltaFromNow } from '../../utils';\nconst previewLength = 4;\nexport const getServerSideProps = withAxios(async ({\n  get\n}) => {\n  const acts = await getData('activity');\n  const previewActs = await Promise.all(acts.slice(0, previewLength).map(async item => _objectSpread(_objectSpread({}, item), {}, {\n    desc: await getContent(item.text)\n  })));\n  return {\n    acts: previewActs.concat(acts.slice(previewLength))\n  };\n});\nexport default withPage(({\n  acts\n}) => {\n  const deleted = acts.filter(a => a.type === 'delete').map(d => d.text);\n  const {\n    0: length,\n    1: setLength\n  } = useState(4);\n  const hasMore = length <= acts.length;\n  return __jsx(MainLayout, {\n    className: \"PageActivity\",\n    title: `动态 - saber2prの窝`\n  }, __jsx(\"ul\", null, acts.slice(0, length).map(({\n    type,\n    text,\n    date,\n    desc\n  }, i) => __jsx(\"li\", {\n    key: text + i\n  }, __jsx(\"div\", {\n    className: \"PageActivity-Content\"\n  }, __jsx(\"div\", {\n    className: \"PageActivity-Type\"\n  }, __jsx(\"strong\", null, matchType(type))), __jsx(\"ul\", null, __jsx(\"li\", {\n    className: \"PageActivity-Name\"\n  }, matchText(type, text)), type !== 'delete' && !deleted.includes(text) && __jsx(\"li\", null, __jsx(Info, {\n    path: text,\n    desc: desc\n  })), __jsx(\"li\", {\n    className: \"PageActivity-Time\"\n  }, __jsx(\"p\", null, timeDeltaFromNow(date))))))), hasMore && __jsx(\"li\", null, __jsx(\"div\", {\n    style: {\n      textAlign: 'center',\n      width: '100%',\n      lineHeight: '2rem'\n    }\n  }, __jsx(\"span\", {\n    style: {\n      textDecoration: 'underline',\n      cursor: 'pointer'\n    },\n    onClick: () => setLength(length + 5)\n  }, \"\\u66F4\\u591A\")))), __jsx(ScrollToTop, null));\n});","map":null,"metadata":{},"sourceType":"module"}