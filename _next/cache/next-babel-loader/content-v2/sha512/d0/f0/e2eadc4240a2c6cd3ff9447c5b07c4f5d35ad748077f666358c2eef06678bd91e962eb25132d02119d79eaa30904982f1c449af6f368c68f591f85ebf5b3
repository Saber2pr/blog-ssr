{"ast":null,"code":"import { fmap } from '@saber2pr/next-with-axios';\nimport { isMobAgent } from '../utils';\nimport { encodeUrl } from '../utils/encodeUrl';\nconst RedirectMap = {\n  '/activity': '/动态',\n  '/about': '/关于',\n  '/links': '/链接'\n};\nexport const withRedirect = fmap(withAxios => (handler, ctx) => {\n  var _ctx$req, _ctx$req2;\n\n  const url = ctx === null || ctx === void 0 ? void 0 : (_ctx$req = ctx.req) === null || _ctx$req === void 0 ? void 0 : _ctx$req.url;\n  const reqHeaders = ctx === null || ctx === void 0 ? void 0 : (_ctx$req2 = ctx.req) === null || _ctx$req2 === void 0 ? void 0 : _ctx$req2.headers;\n  const agent = reqHeaders === null || reqHeaders === void 0 ? void 0 : reqHeaders['user-agent'];\n\n  if (agent && isMobAgent(agent)) {\n    const target = RedirectMap[url] || url;\n    ctx.res.writeHead(302, {\n      Location: `//saber2pr.top/#${encodeUrl(target)}`\n    });\n    ctx.res.end();\n  }\n\n  return withAxios(handler)(ctx);\n});","map":null,"metadata":{},"sourceType":"module"}